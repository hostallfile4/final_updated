{% extends "base_layout.html" %}

{% block title %}Admin Documentation - Zombie Coder Developer Zone{% endblock %}

{% block page_title %}Admin Documentation{% endblock %}

{% block content %}
<div class="row">
    <!-- Documentation Navigation -->
    <div class="col-lg-3">
        <div class="content-card fade-in">
            <div class="content-header">
                <h4 class="content-title">Documentation</h4>
            </div>
            
            <nav class="doc-nav">
                <div class="nav-section">
                    <h6 class="nav-section-title">Getting Started</h6>
                    <ul class="nav-list">
                        <li><a href="#overview" class="nav-link active" onclick="showSection('overview')">System Overview</a></li>
                        <li><a href="#installation" class="nav-link" onclick="showSection('installation')">Installation</a></li>
                        <li><a href="#configuration" class="nav-link" onclick="showSection('configuration')">Configuration</a></li>
                        <li><a href="#quick-start" class="nav-link" onclick="showSection('quick-start')">Quick Start</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h6 class="nav-section-title">API Reference</h6>
                    <ul class="nav-list">
                        <li><a href="#chat-api" class="nav-link" onclick="showSection('chat-api')">Chat API</a></li>
                        <li><a href="#code-api" class="nav-link" onclick="showSection('code-api')">Code API</a></li>
                        <li><a href="#admin-api" class="nav-link" onclick="showSection('admin-api')">Admin API</a></li>
                        <li><a href="#monitoring-api" class="nav-link" onclick="showSection('monitoring-api')">Monitoring API</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h6 class="nav-section-title">Administration</h6>
                    <ul class="nav-list">
                        <li><a href="#server-management" class="nav-link" onclick="showSection('server-management')">Server Management</a></li>
                        <li><a href="#security" class="nav-link" onclick="showSection('security')">Security</a></li>
                        <li><a href="#backup-restore" class="nav-link" onclick="showSection('backup-restore')">Backup & Restore</a></li>
                        <li><a href="#troubleshooting" class="nav-link" onclick="showSection('troubleshooting')">Troubleshooting</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h6 class="nav-section-title">Advanced</h6>
                    <ul class="nav-list">
                        <li><a href="#customization" class="nav-link" onclick="showSection('customization')">Customization</a></li>
                        <li><a href="#deployment" class="nav-link" onclick="showSection('deployment')">Deployment</a></li>
                        <li><a href="#performance" class="nav-link" onclick="showSection('performance')">Performance</a></li>
                        <li><a href="#faq" class="nav-link" onclick="showSection('faq')">FAQ</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>

    <!-- Documentation Content -->
    <div class="col-lg-9">
        <div class="content-card fade-in">
            <div class="content-header">
                <div>
                    <h2 class="content-title">Administration Documentation</h2>
                    <p class="content-subtitle">Complete guide to managing your Zombie Coder Developer Zone</p>
                </div>
                <div>
                    <button class="btn btn-outline-secondary me-2" onclick="printDocumentation()">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadDocumentation()">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>
            
            <!-- Documentation Sections -->
            <div class="doc-content">
                <!-- System Overview -->
                <section id="overview" class="doc-section active">
                    <h3>System Overview</h3>
                    <p>The Zombie Coder Developer Zone is a comprehensive AI-powered development environment that provides:</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <i class="fas fa-robot"></i>
                            <h5>AI Services</h5>
                            <p>Advanced AI models for coding assistance, analysis, and problem-solving</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-server"></i>
                            <h5>Server Management</h5>
                            <p>Centralized control over multiple servers and services</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-chart-line"></i>
                            <h5>Monitoring</h5>
                            <p>Real-time system monitoring and performance analytics</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-shield-alt"></i>
                            <h5>Security</h5>
                            <p>Comprehensive security features and access control</p>
                        </div>
                    </div>
                    
                    <h4>System Architecture</h4>
                    <div class="architecture-diagram">
                        <div class="arch-layer">
                            <h6>Presentation Layer</h6>
                            <p>Web interface, admin panel, API endpoints</p>
                        </div>
                        <div class="arch-layer">
                            <h6>Application Layer</h6>
                            <p>AI models, business logic, data processing</p>
                        </div>
                        <div class="arch-layer">
                            <h6>Data Layer</h6>
                            <p>Database, cache, file storage</p>
                        </div>
                    </div>
                </section>

                <!-- Installation -->
                <section id="installation" class="doc-section">
                    <h3>Installation Guide</h3>
                    
                    <h4>Prerequisites</h4>
                    <ul>
                        <li>Python 3.8 or higher</li>
                        <li>Git</li>
                        <li>MySQL (optional)</li>
                        <li>Ollama (for local AI models)</li>
                    </ul>
                    
                    <h4>Installation Steps</h4>
                    <div class="code-block">
                        <div class="code-header">
                            <span>Terminal</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code># Clone the repository
git clone https://github.com/your-repo/zombie-coder.git
cd zombie-coder

# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt

# Set up environment variables
cp .env.example .env
# Edit .env with your configuration

# Initialize database
python setup_database.py

# Start the server
python model_server.py</code></pre>
                    </div>
                    
                    <h4>Configuration</h4>
                    <p>Edit the <code>.env</code> file to configure your environment:</p>
                    <div class="code-block">
                        <div class="code-header">
                            <span>.env</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code># Server Configuration
API_PORT=5000
DEBUG_MODE=false
LOG_LEVEL=INFO

# Database Configuration
DB_HOST=localhost
DB_PORT=3306
DB_NAME=zombie_coder
DB_USER=root
DB_PASSWORD=your_password

# AI Model Configuration
DEFAULT_MODEL=mistral
MAX_TOKENS=1000
TEMPERATURE=0.7

# Security
GITHUB_TOKEN=your_github_token
API_KEY=your_api_key</code></pre>
                    </div>
                </section>

                <!-- API Reference -->
                <section id="chat-api" class="doc-section">
                    <h3>Chat API Reference</h3>
                    
                    <h4>POST /api/chat</h4>
                    <p>Send messages to AI models and get responses.</p>
                    
                    <h5>Request Body</h5>
                    <div class="code-block">
                        <div class="code-header">
                            <span>JSON</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code>{
  "message": "Hello, how can you help me?",
  "model": "mistral",
  "temperature": 0.7,
  "max_tokens": 1000
}</code></pre>
                    </div>
                    
                    <h5>Response</h5>
                    <div class="code-block">
                        <div class="code-header">
                            <span>JSON</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code>{
  "success": true,
  "response": "Hello! I'm here to help you with...",
  "model": "mistral",
  "response_time": 1.2,
  "tokens_used": 150
}</code></pre>
                    </div>
                    
                    <h5>Example Usage</h5>
                    <div class="code-block">
                        <div class="code-header">
                            <span>JavaScript</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code>fetch('/api/chat', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    message: 'Help me with Python programming',
    model: 'mistral'
  })
})
.then(response => response.json())
.then(data => {
  console.log(data.response);
});</code></pre>
                    </div>
                </section>

                <!-- Server Management -->
                <section id="server-management" class="doc-section">
                    <h3>Server Management</h3>
                    
                    <h4>Starting Servers</h4>
                    <div class="server-commands">
                        <div class="command-item">
                            <h6>Model Server</h6>
                            <code>python model_server.py</code>
                            <p>Main AI model server on port 5000</p>
                        </div>
                        <div class="command-item">
                            <h6>Main Server</h6>
                            <code>python simple_main_server.py</code>
                            <p>Core application server on port 5001</p>
                        </div>
                        <div class="command-item">
                            <h6>Client API</h6>
                            <code>python client_monitoring_api.py</code>
                            <p>Client monitoring API on port 5002</p>
                        </div>
                        <div class="command-item">
                            <h6>Audio API</h6>
                            <code>python zonemind_audio_api.py</code>
                            <p>Audio processing API on port 5003</p>
                        </div>
                    </div>
                    
                    <h4>Health Checks</h4>
                    <p>Monitor server health using these endpoints:</p>
                    <ul>
                        <li><code>GET /api/status</code> - Model server status</li>
                        <li><code>GET /status</code> - Main server status</li>
                        <li><code>GET /api/health</code> - Client API health</li>
                        <li><code>GET /api/audio/health</code> - Audio API health</li>
                    </ul>
                    
                    <h4>Logs</h4>
                    <p>View system logs for debugging:</p>
                    <div class="code-block">
                        <div class="code-header">
                            <span>Terminal</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code># View real-time logs
tail -f logs/system.log

# View error logs
grep ERROR logs/system.log

# View recent activity
tail -n 100 logs/system.log</code></pre>
                    </div>
                </section>

                <!-- Security -->
                <section id="security" class="doc-section">
                    <h3>Security Configuration</h3>
                    
                    <h4>Authentication</h4>
                    <p>Enable authentication to secure your API endpoints:</p>
                    <div class="code-block">
                        <div class="code-header">
                            <span>Configuration</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code># In your .env file
ENABLE_AUTH=true
API_KEY=your_secure_api_key
JWT_SECRET=your_jwt_secret_key

# In your application
from flask_jwt_extended import JWTManager, jwt_required

app.config['JWT_SECRET_KEY'] = os.getenv('JWT_SECRET')
jwt = JWTManager(app)</code></pre>
                    </div>
                    
                    <h4>Rate Limiting</h4>
                    <p>Implement rate limiting to prevent abuse:</p>
                    <div class="code-block">
                        <div class="code-header">
                            <span>Python</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code>from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(
    app,
    key_func=get_remote_address,
    default_limits=["200 per day", "50 per hour"]
)

@app.route('/api/chat', methods=['POST'])
@limiter.limit("10 per minute")
def chat_api():
    # Your chat API code
    pass</code></pre>
                    </div>
                    
                    <h4>HTTPS Configuration</h4>
                    <p>Enable HTTPS for production environments:</p>
                    <div class="code-block">
                        <div class="code-header">
                            <span>SSL Configuration</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code># Generate SSL certificate
openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes

# Run with SSL
app.run(
    host='0.0.0.0',
    port=5000,
    ssl_context=('cert.pem', 'key.pem')
)</code></pre>
                    </div>
                </section>

                <!-- Troubleshooting -->
                <section id="troubleshooting" class="doc-section">
                    <h3>Troubleshooting Guide</h3>
                    
                    <h4>Common Issues</h4>
                    
                    <div class="issue-item">
                        <h5>Server won't start</h5>
                        <p><strong>Solution:</strong> Check if the port is already in use:</p>
                        <code>lsof -i :5000</code>
                        <p>Kill the process or change the port in configuration.</p>
                    </div>
                    
                    <div class="issue-item">
                        <h5>AI models not responding</h5>
                        <p><strong>Solution:</strong> Check if Ollama is running:</p>
                        <code>ollama list</code>
                        <p>Start Ollama service if not running.</p>
                    </div>
                    
                    <div class="issue-item">
                        <h5>Database connection errors</h5>
                        <p><strong>Solution:</strong> Verify database configuration:</p>
                        <code>mysql -u root -p -e "SHOW DATABASES;"</code>
                        <p>Create database if it doesn't exist.</p>
                    </div>
                    
                    <div class="issue-item">
                        <h5>Memory issues</h5>
                        <p><strong>Solution:</strong> Monitor memory usage:</p>
                        <code>htop</code>
                        <p>Consider increasing swap space or optimizing model loading.</p>
                    </div>
                    
                    <h4>Debug Mode</h4>
                    <p>Enable debug mode for detailed error information:</p>
                    <div class="code-block">
                        <div class="code-header">
                            <span>Environment Variable</span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code>DEBUG_MODE=true
LOG_LEVEL=DEBUG</code></pre>
                    </div>
                </section>

                <!-- FAQ -->
                <section id="faq" class="doc-section">
                    <h3>Frequently Asked Questions</h3>
                    
                    <div class="faq-item">
                        <h5>Q: How do I add a new AI model?</h5>
                        <p>A: Add the model configuration to your config file and restart the server. The system will automatically detect and load the new model.</p>
                    </div>
                    
                    <div class="faq-item">
                        <h5>Q: Can I use this in production?</h5>
                        <p>A: Yes, but ensure you configure proper security settings, enable HTTPS, and set up monitoring for production use.</p>
                    </div>
                    
                    <div class="faq-item">
                        <h5>Q: How do I backup my data?</h5>
                        <p>A: Use the admin panel's backup feature or manually export your database and configuration files.</p>
                    </div>
                    
                    <div class="faq-item">
                        <h5>Q: What are the system requirements?</h5>
                        <p>A: Minimum 4GB RAM, 2GB free disk space, Python 3.8+. For AI models, 8GB+ RAM recommended.</p>
                    </div>
                    
                    <div class="faq-item">
                        <h5>Q: How do I update the system?</h5>
                        <p>A: Pull the latest code from git, update dependencies with pip, and restart the servers.</p>
                    </div>
                </section>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .doc-nav {
        max-height: 600px;
        overflow-y: auto;
    }
    
    .nav-section {
        margin-bottom: 25px;
    }
    
    .nav-section-title {
        font-size: 0.9rem;
        font-weight: 600;
        text-transform: uppercase;
        color: var(--primary-color);
        margin-bottom: 10px;
    }
    
    .nav-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .nav-link {
        display: block;
        padding: 8px 12px;
        color: #6c757d;
        text-decoration: none;
        border-radius: 4px;
        transition: all 0.3s ease;
        font-size: 0.9rem;
    }
    
    .nav-link:hover {
        background: var(--light-bg);
        color: var(--primary-color);
    }
    
    .nav-link.active {
        background: var(--accent-color);
        color: white;
    }
    
    .doc-section {
        display: none;
    }
    
    .doc-section.active {
        display: block;
    }
    
    .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 20px 0;
    }
    
    .feature-card {
        background: white;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        transition: all 0.3s ease;
    }
    
    .feature-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .feature-card i {
        font-size: 2rem;
        color: var(--accent-color);
        margin-bottom: 15px;
    }
    
    .feature-card h5 {
        margin-bottom: 10px;
        color: var(--primary-color);
    }
    
    .architecture-diagram {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
    }
    
    .arch-layer {
        background: white;
        border: 1px solid #e9ecef;
        border-radius: 6px;
        padding: 15px;
        margin-bottom: 10px;
    }
    
    .arch-layer:last-child {
        margin-bottom: 0;
    }
    
    .arch-layer h6 {
        margin: 0 0 8px 0;
        color: var(--primary-color);
    }
    
    .code-block {
        background: #2d3748;
        border-radius: 8px;
        margin: 15px 0;
        overflow: hidden;
    }
    
    .code-header {
        background: #4a5568;
        color: white;
        padding: 10px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .code-block pre {
        margin: 0;
        padding: 15px;
        color: #e2e8f0;
        font-family: 'Courier New', monospace;
        font-size: 0.9rem;
        overflow-x: auto;
    }
    
    .server-commands {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }
    
    .command-item {
        background: white;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 15px;
    }
    
    .command-item h6 {
        color: var(--primary-color);
        margin-bottom: 8px;
    }
    
    .command-item code {
        background: #f8f9fa;
        padding: 4px 8px;
        border-radius: 4px;
        font-family: 'Courier New', monospace;
        display: block;
        margin: 8px 0;
    }
    
    .issue-item {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
    }
    
    .issue-item h5 {
        color: var(--danger-color);
        margin-bottom: 8px;
    }
    
    .issue-item code {
        background: #e9ecef;
        padding: 2px 6px;
        border-radius: 4px;
        font-family: 'Courier New', monospace;
    }
    
    .faq-item {
        border-bottom: 1px solid #e9ecef;
        padding: 15px 0;
    }
    
    .faq-item:last-child {
        border-bottom: none;
    }
    
    .faq-item h5 {
        color: var(--primary-color);
        margin-bottom: 8px;
    }
    
    .doc-content {
        max-height: 800px;
        overflow-y: auto;
    }
    
    .doc-content h3 {
        color: var(--primary-color);
        border-bottom: 2px solid var(--accent-color);
        padding-bottom: 10px;
        margin-bottom: 20px;
    }
    
    .doc-content h4 {
        color: var(--secondary-color);
        margin-top: 25px;
        margin-bottom: 15px;
    }
    
    .doc-content h5 {
        color: var(--primary-color);
        margin-top: 20px;
        margin-bottom: 10px;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    // Show documentation section
    function showSection(sectionId) {
        // Hide all sections
        document.querySelectorAll('.doc-section').forEach(section => {
            section.classList.remove('active');
        });
        
        // Show selected section
        document.getElementById(sectionId).classList.add('active');
        
        // Update navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
        });
        
        // Add active class to clicked link
        event.target.classList.add('active');
    }

    // Copy code to clipboard
    function copyCode(button) {
        const codeBlock = button.closest('.code-block');
        const code = codeBlock.querySelector('pre code').textContent;
        
        navigator.clipboard.writeText(code).then(() => {
            // Show success feedback
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-check"></i>';
            button.classList.remove('btn-outline-secondary');
            button.classList.add('btn-success');
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('btn-success');
                button.classList.add('btn-outline-secondary');
            }, 2000);
        }).catch(err => {
            console.error('Failed to copy code:', err);
            alert('Failed to copy code to clipboard');
        });
    }

    // Print documentation
    function printDocumentation() {
        window.print();
    }

    // Download documentation as PDF
    function downloadDocumentation() {
        // This would typically use a PDF generation library
        alert('PDF download feature would be implemented here');
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
        // Show first section by default
        showSection('overview');
        
        // Add smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });
    });
</script>
{% endblock %} 